<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.15.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>BlueBox: How to contribute</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">BlueBox<span id="projectnumber">&#160;0.9</span>
   </div>
   <div id="projectbrief">BlueBox Bluetooth sink</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.15.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div id="doc-content">
<div><div class="header">
  <div class="headertitle"><div class="title">How to contribute </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md263"></a></p>
<p>mruby is an open-source project which is looking forward to each contribution. Contributors agree to license their contribution(s) under MIT license.</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md264"></a>
Your Pull Request</h1>
<p>To make it easy to review and understand your change please keep the following things in mind before submitting your pull request:</p>
<ul>
<li>Work on the latest possible state of <b>mruby/master</b></li>
<li>Create a branch which is dedicated to your change</li>
<li>Test your changes before creating a pull request (<span class="tt">rake test</span>)</li>
<li>If possible write a test case which confirms your change</li>
<li>Don't mix several features or bug-fixes in one pull request</li>
<li>Create a meaningful commit message</li>
<li>Explain your change (i.e. with a link to the issue you are fixing)</li>
<li>Use mrbgem to provide non ISO features (classes, modules and methods) unless you have a special reason to implement them in the core</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="autotoc_md265"></a>
pre-commit</h1>
<p>A framework for managing and maintaining multi-language <span class="tt">pre-commit</span> hooks. <span class="tt">pre-commit</span> can be <a href="https://pre-commit.com/#installation">installed</a> with <span class="tt">pip</span>, <span class="tt">curl</span>, <span class="tt">brew</span> or <span class="tt">conda</span>.</p>
<p>You need to first install <span class="tt">pre-commit</span> and then install the <span class="tt">pre-commit</span> hooks with <span class="tt">pre-commit install</span>. Now <span class="tt">pre-commit</span> will run automatically on git commit!</p>
<p>It's usually a good idea to run the hooks against all the files when adding new hooks (usually <span class="tt">pre-commit</span> will only run on the changed files during git hooks). Use <span class="tt">pre-commit run --all-files</span> to check all files.</p>
<p>To run a single hook use <span class="tt">pre-commit run --all-files &lt;hook_id&gt;</span></p>
<p>To update use <span class="tt">pre-commit autoupdate</span></p>
<p>Sometimes you might need to skip one or more hooks which can be done with the <span class="tt">SKIP</span> environment variable.</p>
<p><span class="tt">$ SKIP=yamllint git commit -m "foo"</span></p>
<p>For convenience, we have added <span class="tt">pre-commit run --all-files</span>, <span class="tt">pre-commit install</span> and <span class="tt">pre-commit autoupdate</span> to both the Makefile and the Rakefile. Run them with:</p>
<ul>
<li><span class="tt">make check</span> or <span class="tt">rake check</span></li>
<li><span class="tt">make checkinstall</span> or <span class="tt">rake checkinstall</span></li>
<li><span class="tt">make checkupdate</span> or <span class="tt">rake checkupdate</span></li>
</ul>
<p>To configure <span class="tt">pre-commit</span> you can modify the config file <a href=".pre-commit-config.yaml">.pre-commit-config.yaml</a>. We use <a href=".github/workflows/lint.yml">GitHub Actions</a> to run <span class="tt">pre-commit</span> on every pull request.</p>
<h2 class="doxsection"><a class="anchor" id="autotoc_md266"></a>
pre-commit quick links</h2>
<ul>
<li><a href="https://pre-commit.com/#quick-start">Quick start</a></li>
<li><a href="https://pre-commit.com/#usage">Usage</a></li>
<li><a href="https://pre-commit.com/#pre-commit-autoupdate">pre-commit autoupdate</a></li>
<li><a href="https://pre-commit.com/#temporarily-disabling-hooks">Temporarily disabling hooks</a></li>
</ul>
<h1 class="doxsection"><a class="anchor" id="autotoc_md267"></a>
Docker</h1>
<p>We have both a <span class="tt">Dockerfile</span> and <span class="tt">docker-compose.yml</span> files in the repository root. You can run these with the command line or use <a href="https://www.docker.com/products/docker-desktop/">Docker Desktop</a>.</p>
<p>The Docker image is running Debian bullseye with Ruby and Python installed. You can build the Docker image with:</p>
<p><span class="tt">$ docker-compose build test</span></p>
<p>So far we just have one service: <span class="tt">test</span>. Running the default <span class="tt">docker-compose</span> command will create the Docker image, spin up a container and then build and run all mruby tests.</p>
<p>The default <span class="tt">docker-compose</span> command is:</p>
<p><span class="tt">$ docker-compose -p mruby run test</span></p>
<p>You can also use Make or Rake to run the default <span class="tt">docker-compose</span> command from above:</p>
<ul>
<li><span class="tt">make composetest</span></li>
<li><span class="tt">rake composetest</span></li>
</ul>
<p>List your Docker images with:</p>
<div class="fragment"><div class="line">$ docker images</div>
<div class="line">REPOSITORY   TAG       IMAGE ID       CREATED          SIZE</div>
<div class="line">mruby-test   latest    ec60f9536948   29 seconds ago   1.29GB</div>
</div><!-- fragment --><p>You can also run any custom <span class="tt">docker-compose</span> command which will override the default. For example to run <span class="tt">pre-commit run --all-files</span> type:</p>
<p><span class="tt">$ docker-compose -p mruby run test pre-commit run --all-files</span></p>
<p>For convenience, you can also run <span class="tt">pre-commit</span> with:</p>
<ul>
<li><span class="tt">make composecheck</span></li>
<li><span class="tt">rake composecheck</span></li>
</ul>
<p>The bonus of running <span class="tt">pre-commit</span> with <span class="tt">docker-compose</span> is that you won't need to install <span class="tt">pre-commit</span> and the hooks on your local machine. And that also means you won't need to install <span class="tt">brew</span>, <span class="tt">conda</span> or <span class="tt">pip</span>.</p>
<p>Note limitation: currently running <span class="tt">pre-commit</span> with <span class="tt">docker-compose</span> we skip the <span class="tt">check-executables-have-shebangs</span> hook.</p>
<p>Two more examples of custom <span class="tt">docker-compose</span> commands are:</p>
<ul>
<li><span class="tt">$ docker-compose -p mruby run test ls</span></li>
<li><span class="tt">$ docker-compose -p mruby run test rake doc:api</span></li>
</ul>
<p>If you want to test using a different <span class="tt">docker-compose</span> YAML config file you can use the <span class="tt">-f</span> flag:</p>
<p><span class="tt">$ docker-compose -p mruby -f docker-compose.test.yml run test</span></p>
<ul>
<li><a href="https://docs.docker.com/compose/">https://docs.docker.com/compose/</a></li>
<li><a href="https://docs.docker.com/engine/reference/commandline/cli/">https://docs.docker.com/engine/reference/commandline/cli/</a></li>
</ul>
<h1 class="doxsection"><a class="anchor" id="autotoc_md268"></a>
Spell Checking</h1>
<p>We are using <span class="tt">pre-commit</span> to run <a href="https://github.com/codespell-project/codespell">codespell</a> to check code for common misspellings. We have a small custom dictionary file <a href="codespell.txt">codespell.txt</a>.</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md269"></a>
Coding conventions</h1>
<p>How to style your C and Ruby code which you want to submit.</p>
<h2 class="doxsection"><a class="anchor" id="autotoc_md270"></a>
C code</h2>
<p>The core part (parser, bytecode-interpreter, core-lib, etc.) of mruby is written in the C programming language. Please note the following hints for your C code:</p>
<h3 class="doxsection"><a class="anchor" id="autotoc_md271"></a>
Comply with C99 (ISO/IEC 9899:1999)</h3>
<p>mruby should be highly portable to other systems and compilers. For this it is recommended to keep your code as close as possible to the C99 standard (<a href="http://www.open-std.org/jtc1/sc22/WG14/www/docs/n1256.pdf">http://www.open-std.org/jtc1/sc22/WG14/www/docs/n1256.pdf</a>).</p>
<p>Visual C++ is also an important target for mruby (supported version is 2013 or later). For this reason features that are not supported by Visual C++ may not be used (e.g. <span class="tt">z</span> of <span class="tt">strftime()</span>).</p>
<p>NOTE: Old GCC requires <span class="tt">-std=gnu99</span> option to enable C99 support.</p>
<h3 class="doxsection"><a class="anchor" id="autotoc_md272"></a>
Reduce library dependencies to a minimum</h3>
<p>The dependencies to libraries should be kept to an absolute minimum. This increases the portability but makes it also easier to cut away parts of mruby on-demand.</p>
<h3 class="doxsection"><a class="anchor" id="autotoc_md273"></a>
Insert a break after the function return value:</h3>
<div class="fragment"><div class="line"><span class="keywordtype">int</span></div>
<div class="line">main(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">  ...</div>
<div class="line">}</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md274"></a>
Ruby code</h2>
<p>Parts of the standard library of mruby are written in the Ruby programming language itself. Please note the following hints for your Ruby code:</p>
<h3 class="doxsection"><a class="anchor" id="autotoc_md275"></a>
Comply with the Ruby standard (ISO/IEC 30170:2012)</h3>
<p>mruby is currently targeting to execute Ruby code which complies to ISO/IEC 30170:2012 (<a href="https://www.iso.org/iso/iso_catalogue/catalogue_tc/catalogue_detail.htm?csnumber=59579">https://www.iso.org/iso/iso_catalogue/catalogue_tc/catalogue_detail.htm?csnumber=59579</a>), unless there's a clear reason, e.g. the latest Ruby has changed behavior from ISO.</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md276"></a>
Building documentation</h1>
<h2 class="doxsection"><a class="anchor" id="autotoc_md277"></a>
mruby API</h2>
<ul>
<li><a href="https://yardoc.org/">YARD</a> - YARD is a documentation generation tool for the Ruby programming language</li>
<li><a href="https://rubygems.org/gems/yard-mruby">yard-mruby</a> - Document mruby sources with YARD</li>
<li><a href="https://rubygems.org/gems/yard-coderay">yard-coderay</a> - Adds coderay syntax highlighting to YARD docs</li>
</ul>
<h2 class="doxsection"><a class="anchor" id="autotoc_md278"></a>
C API</h2>
<ul>
<li><a href="https://www.doxygen.nl/">Doxygen</a> - Generate documentation from source code</li>
<li><a href="https://graphviz.org/">Graphviz</a> - Graphviz is open source graph visualization software </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.15.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
