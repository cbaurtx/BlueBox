\chapter{Limitations and Differences }
\hypertarget{md_managed__components_2espressif____nghttp_2nghttp2_2third-party_2mruby_2doc_2limitations}{}\label{md_managed__components_2espressif____nghttp_2nghttp2_2third-party_2mruby_2doc_2limitations}\index{Limitations and Differences@{Limitations and Differences}}
\label{md_managed__components_2espressif____nghttp_2nghttp2_2third-party_2mruby_2doc_2limitations_autotoc_md401}%
\Hypertarget{md_managed__components_2espressif____nghttp_2nghttp2_2third-party_2mruby_2doc_2limitations_autotoc_md401}%


The philosophy of mruby is to be a lightweight implementation of the Ruby ISO standard. These two objectives are partially contradicting. Ruby is an expressive language with complex implementation details which are difficult to implement in a lightweight manner. To cope with this, limitations to the "{}\+Ruby Compatibility"{} are defined.

This document is collecting these limitations.\hypertarget{md_managed__components_2espressif____nghttp_2nghttp2_2third-party_2mruby_2doc_2limitations_autotoc_md402}{}\doxysection{\texorpdfstring{Integrity}{Integrity}}\label{md_managed__components_2espressif____nghttp_2nghttp2_2third-party_2mruby_2doc_2limitations_autotoc_md402}
This document does not contain a complete list of limitations. Please help to improve it by submitting your findings.\hypertarget{md_managed__components_2espressif____nghttp_2nghttp2_2third-party_2mruby_2doc_2limitations_autotoc_md403}{}\doxysection{\texorpdfstring{{\ttfamily Kernel.\+raise} in rescue clause}{{\ttfamily Kernel.\+raise} in rescue clause}}\label{md_managed__components_2espressif____nghttp_2nghttp2_2third-party_2mruby_2doc_2limitations_autotoc_md403}
{\ttfamily Kernel.\+raise} without arguments does not raise the current exception within a rescue clause.


\begin{DoxyCode}{0}
\DoxyCodeLine{begin}
\DoxyCodeLine{\ \ 1\ /\ 0}
\DoxyCodeLine{rescue}
\DoxyCodeLine{\ \ raise}
\DoxyCodeLine{end}

\end{DoxyCode}
\hypertarget{md_managed__components_2espressif____nghttp_2nghttp2_2third-party_2mruby_2doc_2limitations_autotoc_md404}{}\doxysubsubsection{\texorpdfstring{Ruby \mbox{[}ruby 2.\+0.\+0p645 (2015-\/04-\/13 revision 50299)\mbox{]}}{Ruby \mbox{[}ruby 2.\+0.\+0p645 (2015-\/04-\/13 revision 50299)\mbox{]}}}\label{md_managed__components_2espressif____nghttp_2nghttp2_2third-party_2mruby_2doc_2limitations_autotoc_md404}
{\ttfamily Zero\+Division\+Error} is raised.\hypertarget{md_managed__components_2espressif____nghttp_2nghttp2_2third-party_2mruby_2doc_2limitations_autotoc_md405}{}\doxysubsubsection{\texorpdfstring{mruby \mbox{[}3.\+1.\+0 (2022-\/05-\/12)\mbox{]}}{mruby \mbox{[}3.\+1.\+0 (2022-\/05-\/12)\mbox{]}}}\label{md_managed__components_2espressif____nghttp_2nghttp2_2third-party_2mruby_2doc_2limitations_autotoc_md405}
{\ttfamily Runtime\+Error} is raised instead of {\ttfamily Zero\+Division\+Error}. To re-\/raise the exception, you have to do\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{begin}
\DoxyCodeLine{\ \ 1\ /\ 0}
\DoxyCodeLine{rescue\ =>\ e}
\DoxyCodeLine{\ \ raise\ e}
\DoxyCodeLine{end}

\end{DoxyCode}
\hypertarget{md_managed__components_2espressif____nghttp_2nghttp2_2third-party_2mruby_2doc_2limitations_autotoc_md406}{}\doxysection{\texorpdfstring{Fiber execution can\textquotesingle{}t cross C function boundary}{Fiber execution can\textquotesingle{}t cross C function boundary}}\label{md_managed__components_2espressif____nghttp_2nghttp2_2third-party_2mruby_2doc_2limitations_autotoc_md406}
mruby\textquotesingle{}s {\ttfamily Fiber} is implemented similarly to Lua\textquotesingle{}s co-\/routine. This results in the consequence that you can\textquotesingle{}t switch context within C functions. Only exception is {\ttfamily \doxylink{mruby_8h_a9429af6494bd935dc36877fbbf702dcf}{mrb\+\_\+fiber\+\_\+yield}} at return.\hypertarget{md_managed__components_2espressif____nghttp_2nghttp2_2third-party_2mruby_2doc_2limitations_autotoc_md407}{}\doxysection{\texorpdfstring{{\ttfamily Array} does not support instance variables}{{\ttfamily Array} does not support instance variables}}\label{md_managed__components_2espressif____nghttp_2nghttp2_2third-party_2mruby_2doc_2limitations_autotoc_md407}
To reduce memory consumption {\ttfamily Array} does not support instance variables.


\begin{DoxyCode}{0}
\DoxyCodeLine{class\ Liste\ <\ Array}
\DoxyCodeLine{\ \ def\ initialize(str\ =\ nil)}
\DoxyCodeLine{\ \ \ \ @field\ =\ str}
\DoxyCodeLine{\ \ end}
\DoxyCodeLine{end}
\DoxyCodeLine{}
\DoxyCodeLine{p\ Liste.new\ "{}foobar"{}}

\end{DoxyCode}
\hypertarget{md_managed__components_2espressif____nghttp_2nghttp2_2third-party_2mruby_2doc_2limitations_autotoc_md408}{}\doxysubsubsection{\texorpdfstring{Ruby \mbox{[}ruby 2.\+0.\+0p645 (2015-\/04-\/13 revision 50299)\mbox{]}}{Ruby \mbox{[}ruby 2.\+0.\+0p645 (2015-\/04-\/13 revision 50299)\mbox{]}}}\label{md_managed__components_2espressif____nghttp_2nghttp2_2third-party_2mruby_2doc_2limitations_autotoc_md408}
{\ttfamily \mbox{[}\mbox{]}}\hypertarget{md_managed__components_2espressif____nghttp_2nghttp2_2third-party_2mruby_2doc_2limitations_autotoc_md409}{}\doxysubsubsection{\texorpdfstring{mruby \mbox{[}3.\+1.\+0 (2022-\/05-\/12)\mbox{]}}{mruby \mbox{[}3.\+1.\+0 (2022-\/05-\/12)\mbox{]}}}\label{md_managed__components_2espressif____nghttp_2nghttp2_2third-party_2mruby_2doc_2limitations_autotoc_md409}
{\ttfamily Argument\+Error} is raised.\hypertarget{md_managed__components_2espressif____nghttp_2nghttp2_2third-party_2mruby_2doc_2limitations_autotoc_md410}{}\doxysection{\texorpdfstring{Method visibility}{Method visibility}}\label{md_managed__components_2espressif____nghttp_2nghttp2_2third-party_2mruby_2doc_2limitations_autotoc_md410}
For simplicity reasons no method visibility (public/private/protected) is supported. Those methods are defined, but they are dummy methods.


\begin{DoxyCode}{0}
\DoxyCodeLine{class\ VisibleTest}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ def\ public\_method;\ end}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ private}
\DoxyCodeLine{\ \ def\ private\_method;\ end}
\DoxyCodeLine{}
\DoxyCodeLine{end}
\DoxyCodeLine{}
\DoxyCodeLine{p\ VisibleTest.new.respond\_to?(:private\_method,\ false)}
\DoxyCodeLine{p\ VisibleTest.new.respond\_to?(:private\_method,\ true)}

\end{DoxyCode}
\hypertarget{md_managed__components_2espressif____nghttp_2nghttp2_2third-party_2mruby_2doc_2limitations_autotoc_md411}{}\doxysubsubsection{\texorpdfstring{Ruby \mbox{[}ruby 2.\+0.\+0p645 (2015-\/04-\/13 revision 50299)\mbox{]}}{Ruby \mbox{[}ruby 2.\+0.\+0p645 (2015-\/04-\/13 revision 50299)\mbox{]}}}\label{md_managed__components_2espressif____nghttp_2nghttp2_2third-party_2mruby_2doc_2limitations_autotoc_md411}

\begin{DoxyCode}{0}
\DoxyCodeLine{false}
\DoxyCodeLine{true}

\end{DoxyCode}
\hypertarget{md_managed__components_2espressif____nghttp_2nghttp2_2third-party_2mruby_2doc_2limitations_autotoc_md412}{}\doxysubsubsection{\texorpdfstring{mruby \mbox{[}3.\+1.\+0 (2022-\/05-\/12)\mbox{]}}{mruby \mbox{[}3.\+1.\+0 (2022-\/05-\/12)\mbox{]}}}\label{md_managed__components_2espressif____nghttp_2nghttp2_2third-party_2mruby_2doc_2limitations_autotoc_md412}

\begin{DoxyCode}{0}
\DoxyCodeLine{true}
\DoxyCodeLine{true}

\end{DoxyCode}
\hypertarget{md_managed__components_2espressif____nghttp_2nghttp2_2third-party_2mruby_2doc_2limitations_autotoc_md413}{}\doxysubsection{\texorpdfstring{Visibility Declaration}{Visibility Declaration}}\label{md_managed__components_2espressif____nghttp_2nghttp2_2third-party_2mruby_2doc_2limitations_autotoc_md413}
The declaration form of following visibility methods are not implemented.


\begin{DoxyItemize}
\item {\ttfamily public}
\item {\ttfamily private}
\item {\ttfamily protected}
\item {\ttfamily module\+\_\+function}
\end{DoxyItemize}

Especially, {\ttfamily module\+\_\+function} method is not dummy, but no declaration form.


\begin{DoxyCode}{0}
\DoxyCodeLine{module\ TestModule}
\DoxyCodeLine{\ \ module\_function}
\DoxyCodeLine{\ \ def\ test\_func}
\DoxyCodeLine{\ \ \ \ p\ 'test\_func\ called'}
\DoxyCodeLine{\ \ end}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ test\_func}
\DoxyCodeLine{end}
\DoxyCodeLine{}
\DoxyCodeLine{p\ 'ok'}

\end{DoxyCode}
\hypertarget{md_managed__components_2espressif____nghttp_2nghttp2_2third-party_2mruby_2doc_2limitations_autotoc_md414}{}\doxysubsubsection{\texorpdfstring{Ruby \mbox{[}ruby 2.\+5.\+5p157 (2019-\/03-\/15 revision 67260)\mbox{]}}{Ruby \mbox{[}ruby 2.\+5.\+5p157 (2019-\/03-\/15 revision 67260)\mbox{]}}}\label{md_managed__components_2espressif____nghttp_2nghttp2_2third-party_2mruby_2doc_2limitations_autotoc_md414}

\begin{DoxyCode}{0}
\DoxyCodeLine{ok}

\end{DoxyCode}
\hypertarget{md_managed__components_2espressif____nghttp_2nghttp2_2third-party_2mruby_2doc_2limitations_autotoc_md415}{}\doxysubsubsection{\texorpdfstring{mruby \mbox{[}3.\+1.\+0 (2022-\/05-\/12)\mbox{]}}{mruby \mbox{[}3.\+1.\+0 (2022-\/05-\/12)\mbox{]}}}\label{md_managed__components_2espressif____nghttp_2nghttp2_2third-party_2mruby_2doc_2limitations_autotoc_md415}

\begin{DoxyCode}{0}
\DoxyCodeLine{test.rb:8:\ undefined\ method\ 'test\_func'\ (NoMethodError)}

\end{DoxyCode}
\hypertarget{md_managed__components_2espressif____nghttp_2nghttp2_2third-party_2mruby_2doc_2limitations_autotoc_md416}{}\doxysection{\texorpdfstring{{\ttfamily defined?}}{{\ttfamily defined?}}}\label{md_managed__components_2espressif____nghttp_2nghttp2_2third-party_2mruby_2doc_2limitations_autotoc_md416}
The {\ttfamily defined?} keyword is considered too complex to be fully implemented. It is recommended to use {\ttfamily const\+\_\+defined?} and other reflection methods instead.


\begin{DoxyCode}{0}
\DoxyCodeLine{defined?(Foo)}

\end{DoxyCode}
\hypertarget{md_managed__components_2espressif____nghttp_2nghttp2_2third-party_2mruby_2doc_2limitations_autotoc_md417}{}\doxysubsubsection{\texorpdfstring{Ruby \mbox{[}ruby 2.\+0.\+0p645 (2015-\/04-\/13 revision 50299)\mbox{]}}{Ruby \mbox{[}ruby 2.\+0.\+0p645 (2015-\/04-\/13 revision 50299)\mbox{]}}}\label{md_managed__components_2espressif____nghttp_2nghttp2_2third-party_2mruby_2doc_2limitations_autotoc_md417}

\begin{DoxyCode}{0}
\DoxyCodeLine{nil}

\end{DoxyCode}
\hypertarget{md_managed__components_2espressif____nghttp_2nghttp2_2third-party_2mruby_2doc_2limitations_autotoc_md418}{}\doxysubsubsection{\texorpdfstring{mruby \mbox{[}3.\+1.\+0 (2022-\/05-\/12)\mbox{]}}{mruby \mbox{[}3.\+1.\+0 (2022-\/05-\/12)\mbox{]}}}\label{md_managed__components_2espressif____nghttp_2nghttp2_2third-party_2mruby_2doc_2limitations_autotoc_md418}
{\ttfamily Name\+Error} is raised.\hypertarget{md_managed__components_2espressif____nghttp_2nghttp2_2third-party_2mruby_2doc_2limitations_autotoc_md419}{}\doxysection{\texorpdfstring{{\ttfamily alias} on global variables}{{\ttfamily alias} on global variables}}\label{md_managed__components_2espressif____nghttp_2nghttp2_2third-party_2mruby_2doc_2limitations_autotoc_md419}
Aliasing a global variable works in CRuby but is not part of the ISO standard.


\begin{DoxyCode}{0}
\DoxyCodeLine{alias\ \$a\ \$\_\_a\_\_}

\end{DoxyCode}
\hypertarget{md_managed__components_2espressif____nghttp_2nghttp2_2third-party_2mruby_2doc_2limitations_autotoc_md420}{}\doxysubsubsection{\texorpdfstring{Ruby \mbox{[}ruby 2.\+0.\+0p645 (2015-\/04-\/13 revision 50299)\mbox{]}}{Ruby \mbox{[}ruby 2.\+0.\+0p645 (2015-\/04-\/13 revision 50299)\mbox{]}}}\label{md_managed__components_2espressif____nghttp_2nghttp2_2third-party_2mruby_2doc_2limitations_autotoc_md420}
{\ttfamily nil}\hypertarget{md_managed__components_2espressif____nghttp_2nghttp2_2third-party_2mruby_2doc_2limitations_autotoc_md421}{}\doxysubsubsection{\texorpdfstring{mruby \mbox{[}3.\+1.\+0 (2022-\/05-\/12)\mbox{]}}{mruby \mbox{[}3.\+1.\+0 (2022-\/05-\/12)\mbox{]}}}\label{md_managed__components_2espressif____nghttp_2nghttp2_2third-party_2mruby_2doc_2limitations_autotoc_md421}
Syntax error\hypertarget{md_managed__components_2espressif____nghttp_2nghttp2_2third-party_2mruby_2doc_2limitations_autotoc_md422}{}\doxysection{\texorpdfstring{Operator modification}{Operator modification}}\label{md_managed__components_2espressif____nghttp_2nghttp2_2third-party_2mruby_2doc_2limitations_autotoc_md422}
An operator can\textquotesingle{}t be overwritten by the user.


\begin{DoxyCode}{0}
\DoxyCodeLine{class\ String}
\DoxyCodeLine{\ \ def\ +}
\DoxyCodeLine{\ \ end}
\DoxyCodeLine{end}
\DoxyCodeLine{}
\DoxyCodeLine{'a'\ +\ 'b'}

\end{DoxyCode}
\hypertarget{md_managed__components_2espressif____nghttp_2nghttp2_2third-party_2mruby_2doc_2limitations_autotoc_md423}{}\doxysubsubsection{\texorpdfstring{Ruby \mbox{[}ruby 2.\+0.\+0p645 (2015-\/04-\/13 revision 50299)\mbox{]}}{Ruby \mbox{[}ruby 2.\+0.\+0p645 (2015-\/04-\/13 revision 50299)\mbox{]}}}\label{md_managed__components_2espressif____nghttp_2nghttp2_2third-party_2mruby_2doc_2limitations_autotoc_md423}
{\ttfamily Argument\+Error} is raised. The re-\/defined {\ttfamily +} operator does not accept any arguments.\hypertarget{md_managed__components_2espressif____nghttp_2nghttp2_2third-party_2mruby_2doc_2limitations_autotoc_md424}{}\doxysubsubsection{\texorpdfstring{mruby \mbox{[}3.\+1.\+0 (2022-\/05-\/12)\mbox{]}}{mruby \mbox{[}3.\+1.\+0 (2022-\/05-\/12)\mbox{]}}}\label{md_managed__components_2espressif____nghttp_2nghttp2_2third-party_2mruby_2doc_2limitations_autotoc_md424}
{\ttfamily \textquotesingle{}ab\textquotesingle{}} Behavior of the operator wasn\textquotesingle{}t changed.\hypertarget{md_managed__components_2espressif____nghttp_2nghttp2_2third-party_2mruby_2doc_2limitations_autotoc_md425}{}\doxysection{\texorpdfstring{{\ttfamily Kernel\#binding} is not supported until \mbox{[}3.\+0.\+0 (2021-\/03-\/05)\mbox{]}}{{\ttfamily Kernel\#binding} is not supported until \mbox{[}3.\+0.\+0 (2021-\/03-\/05)\mbox{]}}}\label{md_managed__components_2espressif____nghttp_2nghttp2_2third-party_2mruby_2doc_2limitations_autotoc_md425}
{\ttfamily Kernel\#binding} method is not supported.\hypertarget{md_managed__components_2espressif____nghttp_2nghttp2_2third-party_2mruby_2doc_2limitations_autotoc_md426}{}\doxysubsubsection{\texorpdfstring{Ruby \mbox{[}ruby 2.\+5.\+1p57 (2018-\/03-\/29 revision 63029)\mbox{]}}{Ruby \mbox{[}ruby 2.\+5.\+1p57 (2018-\/03-\/29 revision 63029)\mbox{]}}}\label{md_managed__components_2espressif____nghttp_2nghttp2_2third-party_2mruby_2doc_2limitations_autotoc_md426}

\begin{DoxyCode}{0}
\DoxyCodeLine{\$\ ruby\ -\/e\ 'puts\ Proc.new\ \{\}.binding'}
\DoxyCodeLine{\#<Binding:0x00000e9deabb9950>}

\end{DoxyCode}
\hypertarget{md_managed__components_2espressif____nghttp_2nghttp2_2third-party_2mruby_2doc_2limitations_autotoc_md427}{}\doxysection{\texorpdfstring{{\ttfamily nil?} redefinition in conditional expressions}{{\ttfamily nil?} redefinition in conditional expressions}}\label{md_managed__components_2espressif____nghttp_2nghttp2_2third-party_2mruby_2doc_2limitations_autotoc_md427}
Redefinition of {\ttfamily nil?} is ignored in conditional expressions.


\begin{DoxyCode}{0}
\DoxyCodeLine{a\ =\ "{}a"{}}
\DoxyCodeLine{def\ a.nil?}
\DoxyCodeLine{\ \ true}
\DoxyCodeLine{end}
\DoxyCodeLine{puts(a.nil?\ ?\ "{}truthy"{}\ :\ "{}falsy"{})}

\end{DoxyCode}


Ruby outputs {\ttfamily truthy}. mruby outputs {\ttfamily falsy}.\hypertarget{md_managed__components_2espressif____nghttp_2nghttp2_2third-party_2mruby_2doc_2limitations_autotoc_md428}{}\doxysection{\texorpdfstring{Argument Destructuring}{Argument Destructuring}}\label{md_managed__components_2espressif____nghttp_2nghttp2_2third-party_2mruby_2doc_2limitations_autotoc_md428}

\begin{DoxyCode}{0}
\DoxyCodeLine{def\ m(a,(b,c),d);\ p\ [a,b,c,d];\ end}
\DoxyCodeLine{m(1,[2,3],4)\ \ \#\ =>\ [1,2,3,4]}

\end{DoxyCode}


Destructured arguments ({\ttfamily b} and {\ttfamily c} in above example) cannot be accessed from the default expression of optional arguments and keyword arguments, since actual assignment is done after the evaluation of those default expressions. Thus\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{def\ f(a,(b,c),d=b)}
\DoxyCodeLine{\ \ p\ [a,b,c,d]}
\DoxyCodeLine{end}
\DoxyCodeLine{f(1,[2,3])}

\end{DoxyCode}


CRuby gives {\ttfamily \mbox{[}1,2,3,nil\mbox{]}}. mruby raises {\ttfamily No\+Method\+Error} for {\ttfamily b}.

Keyword argument expansion has similar restrictions. The following example, gives {\ttfamily \mbox{[}1, 1\mbox{]}} for CRuby, mruby raises {\ttfamily No\+Method\+Error} for {\ttfamily b}.


\begin{DoxyCode}{0}
\DoxyCodeLine{def\ g(a:\ 1,\ b:\ a)}
\DoxyCodeLine{\ \ p\ [a,b]}
\DoxyCodeLine{end}
\DoxyCodeLine{g(a:1)}

\end{DoxyCode}
 