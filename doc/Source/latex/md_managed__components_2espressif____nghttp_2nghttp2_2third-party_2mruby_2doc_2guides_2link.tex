\chapter{Linking {\ttfamily libmruby} to your application }
\hypertarget{md_managed__components_2espressif____nghttp_2nghttp2_2third-party_2mruby_2doc_2guides_2link}{}\label{md_managed__components_2espressif____nghttp_2nghttp2_2third-party_2mruby_2doc_2guides_2link}\index{Linking $<$tt$>$libmruby$<$/tt$>$ to your application@{Linking $<$tt$>$libmruby$<$/tt$>$ to your application}}
\label{md_managed__components_2espressif____nghttp_2nghttp2_2third-party_2mruby_2doc_2guides_2link_autotoc_md337}%
\Hypertarget{md_managed__components_2espressif____nghttp_2nghttp2_2third-party_2mruby_2doc_2guides_2link_autotoc_md337}%


You have two ways to link {\ttfamily libmruby} to your application.


\begin{DoxyItemize}
\item using executable gem.
\item using normal compilation process
\end{DoxyItemize}\hypertarget{md_managed__components_2espressif____nghttp_2nghttp2_2third-party_2mruby_2doc_2guides_2link_autotoc_md338}{}\doxysection{\texorpdfstring{Executable Gems}{Executable Gems}}\label{md_managed__components_2espressif____nghttp_2nghttp2_2third-party_2mruby_2doc_2guides_2link_autotoc_md338}
If your application is relatively small, {\ttfamily mrbgem} is an easier way to create the executable. By tradition, the gem name start with {\ttfamily mruby-\/bin-\/}, e.\+g. {\ttfamily mruby-\/bin-\/debugger}.\hypertarget{md_managed__components_2espressif____nghttp_2nghttp2_2third-party_2mruby_2doc_2guides_2link_autotoc_md339}{}\doxysubsection{\texorpdfstring{{\ttfamily mrbgem.\+rake} file}{{\ttfamily mrbgem.\+rake} file}}\label{md_managed__components_2espressif____nghttp_2nghttp2_2third-party_2mruby_2doc_2guides_2link_autotoc_md339}
The executable name is specified in {\ttfamily mrbgem.\+rake} file at the top of your {\ttfamily mrbgem} directory.


\begin{DoxyCode}{0}
\DoxyCodeLine{MRuby::Gem::Specification.new('mruby-\/bin-\/example')\ do\ |spec|}
\DoxyCodeLine{\ \ spec.license\ =\ 'MIT'}
\DoxyCodeLine{\ \ spec.author\ \ =\ 'mruby\ developers'}
\DoxyCodeLine{\ \ spec.summary\ =\ 'Example\ for\ executable\ command\ gem'}
\DoxyCodeLine{\ \ spec.bins\ =\ \%w(mruby-\/example)\ \ \ \ \#\ <-\/\ this\ is\ binary\ name}
\DoxyCodeLine{end}

\end{DoxyCode}
\hypertarget{md_managed__components_2espressif____nghttp_2nghttp2_2third-party_2mruby_2doc_2guides_2link_autotoc_md340}{}\doxysubsection{\texorpdfstring{Source tree structure}{Source tree structure}}\label{md_managed__components_2espressif____nghttp_2nghttp2_2third-party_2mruby_2doc_2guides_2link_autotoc_md340}
The source file for the gem executable should be in {\ttfamily \texorpdfstring{$<$}{<}gem-\/name\texorpdfstring{$>$}{>}/tools/\texorpdfstring{$<$}{<}bin-\/name\texorpdfstring{$>$}{>}}. Currently, we support C or C++ source code ({\ttfamily .c}, {\ttfamily .cpp}, {\ttfamily .cxx}, {\ttfamily .cc}) for the executable. Ruby source files are not supported. Put the functionality in the different gem and specify dependency to it in {\ttfamily mrbgem.\+rake}.\hypertarget{md_managed__components_2espressif____nghttp_2nghttp2_2third-party_2mruby_2doc_2guides_2link_autotoc_md341}{}\doxysection{\texorpdfstring{Normal compilation process}{Normal compilation process}}\label{md_managed__components_2espressif____nghttp_2nghttp2_2third-party_2mruby_2doc_2guides_2link_autotoc_md341}
The {\ttfamily libmruby} is a normal library so that you can just link it to your application. Specify proper compiler options ({\ttfamily -\/I} etc.) and linker options ({\ttfamily -\/lmruby} etc.) to compile and link your application. Specify those options in your build script (e.\+g. {\ttfamily Makefile}).\hypertarget{md_managed__components_2espressif____nghttp_2nghttp2_2third-party_2mruby_2doc_2guides_2link_autotoc_md342}{}\doxysubsection{\texorpdfstring{Compiler options}{Compiler options}}\label{md_managed__components_2espressif____nghttp_2nghttp2_2third-party_2mruby_2doc_2guides_2link_autotoc_md342}
You need to specify compiler options that are compatible to mruby configuration, for example\+:


\begin{DoxyItemize}
\item {\ttfamily -\/I} to specify the place for mruby header files
\item {\ttfamily -\/D} to specify mruby configuration macros
\end{DoxyItemize}

To retrieve compiler options used to build {\ttfamily mruby}, you can use {\ttfamily mruby-\/config} command with following options\+:


\begin{DoxyItemize}
\item {\ttfamily -\/-\/cc} compiler name
\item {\ttfamily -\/-\/cflags} options passed to compiler
\end{DoxyItemize}


\begin{DoxyCode}{0}
\DoxyCodeLine{\$\ mruby-\/config\ -\/-\/cflags}
\DoxyCodeLine{-\/std=gnu99\ -\/g\ -\/O3\ -\/Wall\ -\/DMRB\_GC\_FIXED\_ARENA\ -\/I/home/matz/work/mruby/include\ -\/I/home/matz/work/mruby/build/host/include}

\end{DoxyCode}
\hypertarget{md_managed__components_2espressif____nghttp_2nghttp2_2third-party_2mruby_2doc_2guides_2link_autotoc_md343}{}\doxysubsection{\texorpdfstring{Linker options}{Linker options}}\label{md_managed__components_2espressif____nghttp_2nghttp2_2third-party_2mruby_2doc_2guides_2link_autotoc_md343}
Just like compiler options, you need to specify linker options that are compatible to mruby configuration.

To retrieve linker options, you can use {\ttfamily mruby-\/config} with following options\+:


\begin{DoxyItemize}
\item {\ttfamily -\/-\/ld} linker name
\item {\ttfamily -\/-\/ldflags} options passed to linker
\item {\ttfamily -\/-\/ldflags-\/before-\/libs} options passed to linker before linked libraries
\item {\ttfamily -\/-\/libs} linked libraries
\end{DoxyItemize}


\begin{DoxyCode}{0}
\DoxyCodeLine{\$\ mruby-\/config\ -\/-\/ldflags}
\DoxyCodeLine{-\/L/home/matz/work/mruby/build/host/lib}
\DoxyCodeLine{}
\DoxyCodeLine{\$\ mruby-\/config\ -\/-\/ldflags-\/before-\/libs}
\DoxyCodeLine{\#\ <nothing\ in\ this\ case>}
\DoxyCodeLine{}
\DoxyCodeLine{\$\ mruby-\/config\ -\/-\/libs}
\DoxyCodeLine{-\/lmruby\ -\/lm}

\end{DoxyCode}
 